# port of HTTP
port: 1087

# port of SOCKS5
socks-port: 1086

# redir port for Linux and macOS
# redir-port: 7892

allow-lan: false

# Only applicable when setting allow-lan to true
# "*": bind all IP addresses
# 192.168.122.11: bind a single IPv4 address
# "[aaaa::a8aa:ff:fe09:57d8]": bind a single IPv6 address
# bind-address: "*"

# Rule / Global / Direct (default is Rule)
mode: Rule

# set log level to stdout (default is info)
# info / warning / error / debug / silent
log-level: silent

# RESTful API for clash
external-controller: 127.0.0.1:9090

# you can put the static web resource (such as clash-dashboard) to a directory, and clash would serve in `${API}/ui`
# input is a relative path to the configuration directory or an absolute path
# external-ui: folder

# Secret for RESTful API (Optional)
# secret: ""

# experimental feature
experimental:
  ignore-resolve-fail: true # ignore dns resolve fail, default value is true
  # interface-name: en0 # outbound interface name

# authentication of local SOCKS5/HTTP(S) server
# authentication:
#  - "user1:pass1"
#  - "user2:pass2"

# # experimental hosts, support wildcard (e.g. *.clash.dev Even *.foo.*.example.com)
# # static domain has a higher priority than wildcard domain (foo.example.com > *.example.com)
# hosts:
#   '*.clash.dev': 127.0.0.1
#   'alpha.clash.dev': '::1'

dns:
  enable: true # set true to enable dns (default is false)
  ipv6: false # default is false
  listen: 0.0.0.0:53
  default-nameserver: # resolve dns nameserver host, should fill pure IP
    - "8.8.8.8:53" # Google
    - "8.8.4.4:53" # Google
    - "1.1.1.1:53" # Cloudflare
    - "1.0.0.1:53" # Cloudflare
    - "208.67.222.222:53" # OpenDNS
    - "208.67.220.220:53" # OpenDNS
    #- "8.26.56.26:53"  # NuSEC DNS
    #- "8.20.247.20:53"  # NuSEC DNS
    #- "199.85.126.10:53"  # Norton DNS
    #- "199.85.127.10:53"  # Norton DNS
    #- "156.154.70.5:53"  # Neustar DNS
    #- "156.154.71.5:53"  # Neustar DNS
    #- "9.9.9.9:53" # Quad9 DNS
    #- "149.112.112.112:53" # Quad9 DNS
    #- "195.46.39.39:53"  # SafeDNS DNS
    #- "195.46.39.40:53"  # SafeDNS DNS
  enhanced-mode: redir-host # or fake-ip
  fake-ip-range: 198.18.0.1/16 # if you don't know what it is, don't change it
  fake-ip-filter: # fake ip white domain list
    - "*.lan"
    - localhost.ptlogin2.qq.com
  nameserver:
    - "223.5.5.5:53" # Alibaba
    - "223.6.6.6:53" # Alibaba
    - "119.28.28.28:53" # DNSPod
    - "119.29.29.29:53" # DNSPod
    - "182.254.116.116:53" # Tencent
    - "182.254.118.118:53" # Tencent
    #- "180.76.76.76:53" # Baidu
    #- "2400:da00::6666:53"  # Baidu
    - "117.50.10.10:53" # OneDNS
    - "52.80.52.52:53" # OneDNS
    #- "1.2.4.8:53"  # CNNIC
    #- "210.2.4.8:53"  # CNNIC
    #- "114.114.114.114:53"  # 114 DNS
    #- "114.114.115.115:53"  # 114 DNS
    - "101.226.4.6:53" # DNS PAI
    - "218.30.118.6:53" # DNS PAI
  fallback: # concurrent request with nameserver, fallback used when GEOIP country isn't CN
    - "https://dns.google/dns-query" # Google
    #- "https://doh.opendns.com/dns-query"  # OpenDNS
    - "https://cloudflare-dns.com/dns-query" # Cloudflare
    #- "https://dns.quad9.net/dns-query"  # Quad9
    #- "https://doh.dns.sb/dns-query"  # DNS.SB
    - "https://dns.rubyfish.cn/dns-query" # RubyFish
    - "https://dns.233py.com/dns-query" # GeekDNS
    #- "https://dns.adguard.com/dns-query"  # ADGuard
    - "tls://8.8.8.8:853" # Google
    - "tls://8.8.4.4:853" # Google
    #- "tls://208.67.222.222:853"  # OpenDNS
    #- "tls://208.67.220.220:853"  # OpenDNS
    - "tls://1.1.1.1:853" # Cloudflare
    - "tls://1.0.0.1:853" # Cloudflare
    #- "tls://9.9.9.9:853"  # Quad9
    #- "tls://149.112.112.112:853"  # Quad9
    #- "tls://185.222.222.222:853"  # DNS.SB
    #- "tls://185.184.222.222:853"  # DNS.SB
    - "tls://ea-dns.rubyfish.cn:853" # RubyFish
    - "tls://uw-dns.rubyfish.cn:853" # RubyFish
    #- "tls://hk-dns.233py.com:853"  # GeekDNS
    #- "tls://us-dns.233py.com:853"  # GeekDNS
    #- "tls://176.103.130.130:853"  # ADGuard
    #- "tls://176.103.130.131:853"  # ADGuard
  fallback-filter:
    geoip: true # default
    ipcidr: # ips in these subnets will be considered polluted
      - 240.0.0.0/4

proxies:
  - name: "ss"
    type: ss
    server: server
    port: 443
    cipher: xchacha20-ietf-poly1305
    password: "password"

proxy-groups:
  # relay chains the proxies. proxies shall not contain a proxy-group. No UDP support.
  # Traffic: clash <-> http <-> vmess <-> ss1 <-> ss2 <-> Internet
  - name: relay
    type: relay
    proxies:
      - ss

  # url-test select which proxy will be used by benchmarking speed to a URL.
  - name: url-test
    type: url-test
    proxies:
      - ss
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  # fallback select an available policy by priority. The availability is tested by accessing an URL, just like an auto url-test group.
  - name: fallback
    type: fallback
    proxies:
      - ss
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  # load-balance: The request of the same eTLD will be dial on the same proxy.
  - name: load-balance
    type: load-balance
    proxies:
      - ss
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  # select is used for selecting proxy or proxy group
  # you can use RESTful API to switch proxy, is recommended for use in GUI.
  - name: user-select
    type: select
    proxies:
      - url-test
      - fallback
      - load-balance

rules:
  - DOMAIN-KEYWORD,-cn,DIRECT
  - DOMAIN-SUFFIX,cn,DIRECT
  # - DOMAIN-SUFFIX,ac.cn,DIRECT
  # - DOMAIN-SUFFIX,com.cn,DIRECT
  # - DOMAIN-SUFFIX,edu.cn,DIRECT
  # - DOMAIN-SUFFIX,gov.cn,DIRECT
  # - DOMAIN-SUFFIX,mil.cn,DIRECT
  # - DOMAIN-SUFFIX,net.cn,DIRECT
  # - DOMAIN-SUFFIX,org.cn,DIRECT
  # - DOMAIN-SUFFIX,ah.cn,DIRECT
  # - DOMAIN-SUFFIX,bj.cn,DIRECT
  # - DOMAIN-SUFFIX,cq.cn,DIRECT
  # - DOMAIN-SUFFIX,fj.cn,DIRECT
  # - DOMAIN-SUFFIX,gd.cn,DIRECT
  # - DOMAIN-SUFFIX,gs.cn,DIRECT
  # - DOMAIN-SUFFIX,gz.cn,DIRECT
  # - DOMAIN-SUFFIX,gx.cn,DIRECT
  # - DOMAIN-SUFFIX,ha.cn,DIRECT
  # - DOMAIN-SUFFIX,hb.cn,DIRECT
  # - DOMAIN-SUFFIX,he.cn,DIRECT
  # - DOMAIN-SUFFIX,hi.cn,DIRECT
  # - DOMAIN-SUFFIX,hl.cn,DIRECT
  # - DOMAIN-SUFFIX,hk.cn,DIRECT
  # - DOMAIN-SUFFIX,hn.cn,DIRECT
  # - DOMAIN-SUFFIX,jl.cn,DIRECT
  # - DOMAIN-SUFFIX,js.cn,DIRECT
  # - DOMAIN-SUFFIX,jx.cn,DIRECT
  # - DOMAIN-SUFFIX,ln.cn,DIRECT
  # - DOMAIN-SUFFIX,mo.cn,DIRECT
  # - DOMAIN-SUFFIX,nm.cn,DIRECT
  # - DOMAIN-SUFFIX,nx.cn,DIRECT
  # - DOMAIN-SUFFIX,qh.cn,DIRECT
  # - DOMAIN-SUFFIX,sc.cn,DIRECT
  # - DOMAIN-SUFFIX,sd.cn,DIRECT
  # - DOMAIN-SUFFIX,sh.cn,DIRECT
  # - DOMAIN-SUFFIX,sn.cn,DIRECT
  # - DOMAIN-SUFFIX,sx.cn,DIRECT
  # - DOMAIN-SUFFIX,tj.cn,DIRECT
  # - DOMAIN-SUFFIX,tw.cn,DIRECT
  # - DOMAIN-SUFFIX,xj.cn,DIRECT
  # - DOMAIN-SUFFIX,xz.cn,DIRECT
  # - DOMAIN-SUFFIX,yn.cn,DIRECT
  # - DOMAIN-SUFFIX,zj.cn,DIRECT
  - DOMAIN-SUFFIX,local,DIRECT
  - DOMAIN-SUFFIX,localhost,DIRECT
  #- DOMAIN-SUFFIX,ip6-localhost,DIRECT
  #- DOMAIN-SUFFIX,ip6-loopback,DIRECT
  #- IP-CIDR,0.0.0.0/8,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,100.64.0.0/10,DIRECT
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  #- IP-CIDR,192.0.0.0/24,DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  #- IP-CIDR,198.18.0.0/15,DIRECT
  #- IP-CIDR6,::/128,DIRECT
  #- IP-CIDR6,::1/128,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,user-select
